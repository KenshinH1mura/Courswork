<Window x:Class="StreamingService.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="StreamingService - Управление подписками и просмотрами" Height="700" Width="900"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <TabControl>
            <!-- Профиль -->
            <TabItem Header="Профиль">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <TextBlock Text="Мой профиль" FontSize="22" FontWeight="Bold" Margin="0,0,0,15"/>

                        <Border Background="#f5f5f5" Padding="15" CornerRadius="5" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="Основная информация" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Text="Имя:" Grid.Row="0" Grid.Column="0" Margin="0,5" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtName" Grid.Row="0" Grid.Column="1" Margin="10,5" Padding="5" Text="Тестовый пользователь"/>

                                    <TextBlock Text="Email:" Grid.Row="1" Grid.Column="0" Margin="0,5" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtEmail" Grid.Row="1" Grid.Column="1" Margin="10,5" Padding="5" Text="test@example.com"/>

                                    <TextBlock Text="Возраст:" Grid.Row="2" Grid.Column="0" Margin="0,5" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtAge" Grid.Row="2" Grid.Column="1" Margin="10,5" Padding="5" Text="25"/>

                                    <TextBlock Text="Страна:" Grid.Row="3" Grid.Column="0" Margin="0,5" VerticalAlignment="Center"/>
                                    <TextBox x:Name="txtCountry" Grid.Row="3" Grid.Column="1" Margin="10,5" Padding="5" Text="Россия"/>
                                </Grid>
                                <Button Content="Сохранить изменения" Click="SaveProfile_Click" 
                                        Padding="15,8" Margin="0,10,0,0" Background="#007acc" Foreground="White"/>
                            </StackPanel>
                        </Border>

                        <TextBlock Text="История платежей" FontSize="18" FontWeight="SemiBold" Margin="0,10,0,10"/>
                        <ListView x:Name="lvPayments" Height="200" BorderThickness="1" BorderBrush="#ccc">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Дата" DisplayMemberBinding="{Binding payment_date, StringFormat=dd.MM.yyyy}" Width="100"/>
                                    <GridViewColumn Header="Сумма" DisplayMemberBinding="{Binding amount, StringFormat={}{0}₽}" Width="80"/>
                                    <GridViewColumn Header="Тариф" DisplayMemberBinding="{Binding Subscription.SubscriptionPlan.name}" Width="120"/>
                                    <GridViewColumn Header="Метод оплаты" DisplayMemberBinding="{Binding PaymentMethod.method_name}" Width="120"/>
                                    <GridViewColumn Header="Статус подписки" DisplayMemberBinding="{Binding Subscription.status}" Width="120"/>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Подписки -->
            <TabItem Header="Подписки">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <TextBlock Text="Управление подписками" FontSize="22" FontWeight="Bold" Margin="0,0,0,15"/>

                        <Border Background="#fff8e1" Padding="15" CornerRadius="5" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock x:Name="tbCurrentSubscription" Text="Текущая подписка: Отсутствует" FontSize="16" FontWeight="SemiBold"/>
                                <TextBlock x:Name="tbSubscriptionStatus" Text="Статус: Неактивна" FontSize="14" Margin="0,5,0,0"/>
                                <TextBlock x:Name="tbSubscriptionDate" Text="" FontSize="12" Foreground="#666" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>

                        <TextBlock Text="Выбор новой подписки" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10"/>
                        <ComboBox x:Name="cmbSubscriptionPlans" DisplayMemberPath="name" 
                                  Margin="0,0,0,10" Padding="8" FontSize="12"/>
                        <Button Content="Активировать подписку" Click="BuySubscription_Click" 
                                Padding="15,8" Background="#28a745" Foreground="White" FontWeight="SemiBold"/>
                        <Button Content="Приостановить подписку" Click="PauseSubscription_Click" 
                                Padding="15,8" Margin="0,5,0,15" Background="#ffc107" Foreground="Black"/>

                        <TextBlock Text="Доступные тарифные планы:" FontSize="18" FontWeight="SemiBold" Margin="0,10,0,10"/>
                        <ListView x:Name="lvAvailablePlans" Height="200" BorderThickness="1" BorderBrush="#ccc">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Название" DisplayMemberBinding="{Binding name}" Width="120"/>
                                    <GridViewColumn Header="Цена в месяц" DisplayMemberBinding="{Binding monthly_price, StringFormat={}{0}₽}" Width="100"/>
                                    <GridViewColumn Header="Описание" DisplayMemberBinding="{Binding description}" Width="300"/>
                                    <GridViewColumn Header="Цикл оплаты" DisplayMemberBinding="{Binding billing_cycle}" Width="100"/>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Каталог -->
            <TabItem Header="Каталог">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <TextBlock Text="Каталог контента" FontSize="22" FontWeight="Bold" Margin="0,0,0,15"/>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                            <TextBlock Text="Фильтр по жанру:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox x:Name="cmbGenres" DisplayMemberPath="name" Width="150" 
                                      SelectionChanged="GenreFilter_Changed"/>
                            <Button Content="Сбросить фильтр" Click="ResetFilter_Click" 
                                    Margin="10,0,0,0" Padding="8,4"/>
                        </StackPanel>

                        <ListView x:Name="lvMedia" Height="350" SelectionChanged="Media_SelectionChanged"
                                  BorderThickness="1" BorderBrush="#ccc">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Название" DisplayMemberBinding="{Binding title}" Width="200"/>
                                    <GridViewColumn Header="Жанр" DisplayMemberBinding="{Binding Genre.name}" Width="100"/>
                                    <GridViewColumn Header="Рейтинг" DisplayMemberBinding="{Binding rating}" Width="80"/>
                                    <GridViewColumn Header="Дата выхода" DisplayMemberBinding="{Binding release_date, StringFormat=dd.MM.yyyy}" Width="100"/>
                                    <GridViewColumn Header="Описание" DisplayMemberBinding="{Binding description}" Width="300"/>
                                </GridView>
                            </ListView.View>
                        </ListView>

                        <Button Content="Смотреть выбранный контент" Click="WatchMedia_Click" 
                                Padding="15,8" Margin="0,10,0,0" Background="#007acc" Foreground="White"
                                FontSize="14" FontWeight="SemiBold"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- История просмотров -->
            <TabItem Header="История просмотров">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15">
                        <TextBlock Text="История просмотров" FontSize="22" FontWeight="Bold" Margin="0,0,0,15"/>

                        <TextBlock x:Name="tbStats" Text="" FontSize="12" Foreground="#666" Margin="0,0,0,10"/>

                        <ListView x:Name="lvViewHistory" Height="450" BorderThickness="1" BorderBrush="#ccc">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Название" DisplayMemberBinding="{Binding Media.title}" Width="200"/>
                                    <GridViewColumn Header="Дата просмотра" DisplayMemberBinding="{Binding view_date, StringFormat=dd.MM.yyyy HH:mm}" Width="120"/>
                                    <GridViewColumn Header="Время просмотра (мин)" DisplayMemberBinding="{Binding watch_time}" Width="120"/>
                                    <GridViewColumn Header="Устройство" DisplayMemberBinding="{Binding device}" Width="100"/>
                                    <GridViewColumn Header="Жанр" DisplayMemberBinding="{Binding Media.Genre.name}" Width="100"/>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
